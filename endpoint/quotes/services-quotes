## Services-Quotes Collection [/services-quotes]

Services Quote endpoint allows you to create the Services sales order in SAP. Responses from this API will be retuned in JSON format only. All the customer & product details provided during services sales journey would be captured and posted to SAP which will then create an real time service contract. 

>`Note:` Services Quote API will be able to handle only either a bundle product or an individual product at a time.

#### Services Quote
Services Quote as an entity represents following attributes.

| Property | Type | As request | As response | Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| id | string | `Optional` | `Returned always` | When an request is sent, the `id` attribute is unknown and hence it must be null. When the actual services lead is created, the response will have the `id` populated.|
| title | string | `Mandatory` | `Returned always` | Title of customer. |
| firstName | string | `Mandatory` | `Returned always` | First name of customer. |
| lastName | string | `Mandatory`| `Returned always` | LastName of customer. |
| emailAddress | string | `Mandatory` | `Returned always` | Email address of customer |
| telephoneNumber | string | `Mandatory`| `Returned always` | Phone number of customer |
| premiseID | string | `Optional` | `Returned always` | Will always be null. |
| bothAddressSame | boolean | `Optional` | `Returned always` | Should be `true` if both billing address & supply address are same. |
| supplyAddress | Address | `Mandatory` | `Returned always` | Supply address of customer. Any one of the following - house number, flat number, house name and postal town and postcode are mandatory. Other address attributes must be passed if available.  |
| billingAddress | Address | `Optional` | `Returned always` | Billing address of customer. Value will not be available in response if billing address is not passed. |
| paymentMethod | string | `Mandatory` | `Returned always` | Payment method which customer choose.  |
| jci | boolean | `Optional` | `Returned always` | Status based on whether JCI was offered to customer or not. |
| status | string | `Optional` | `Returned always` | This value will always be null and is used in controller endpoint |
| servicesAccountNumber | string | `Optional` | `Returned always` | This value will always be null and is used in controller endpoint |
| productFeatures | string[] | `Mandatory` | `Returned always` | List of product features for which the quote is to be created. |
| productConfigurations | ProductConfigurations[] | `Optional` | `Returned always` | List of product configurations for which the quote is to be created. |

##### ProductConfigurations 
| Property | Type | As request | As response |Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| productFeature | string | `Mandatory` | `Returned always` | Product feature id for which the appliances details to be provided. |
| productAppliances | ProductAppliances[] | `Mandatory` | `Returned always` | Appliances details of a product with appliance type, make, model and age information. |

##### ProductAppliances 
| Property | Type | As request | As response |Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| applianceId | string | `Mandatory` | `Returned always` | Appliance id of a product which customer choosen. |
| makeId | string| `Optional` | `Returned always` | If customer choose any make the value can be passed. If value is not passed it is defaulted to value `Default`.|
| modelId | string | `Optional` | `Returned always` | If customer choose any model the value can be passed. If value is not passed it is defaulted to value `Default`.|
| age | Integer | `Optional` | `Returned always` | If customer choose any age the value can be passed. If value is not passed it is defaulted to value `5`.|


### Post a services quote to the backend systems [POST /services-quotes]

+ Request (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

    + Body

            {
                "servicesQuote": {
                    "id": null,
                    "title": "Mr",
                    "firstName": "Ravi",
                    "lastName": "Kumar",
                    "emailAddress": "ravi.kumar@britfss.co.uk",
                    "telephoneNumber": "07738998190",
                    "premiseID": null,
                    "bothAddressSame": false,
                    "supplyAddress": {
                        "flatNumber": 14,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ",
                        "country": null
                    },
                    "billingAddress": {
                        "flatNumber": 17,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ",
                        "country": null
                    },
                    "paymentMethod": "MDD",
                    "jci": false,
                    "status": null,
                    "servicesAccountNumber": null,
                    "productFeatures": [
                        "HC4|HC4-CH|CNI2|CHB|MDD",
                        "HC4|HC4-PD|DNI2|PLDR|MDD",
                        "HC4|HC4-HEC|HNI2|EWR|MDD"
                    ],
                    "productConfigurations": [
                        {
                            "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                            "productAppliances": [
                                {
                                    "applianceId": "CHB",
                                    "makeId": "QUdBLS0tQUdDIEhlYXRpbmc",
                                    "modelId": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                    "age": "5"
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "productAppliances": [
                                {
                                    "applianceId": "PLDR",
                                    "makeId": null,
                                    "modelId": null,
                                    "age": null
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                            "productAppliances": [
                                {
                                    "applianceId": "EWR",
                                    "makeId": null,
                                    "modelId": null,
                                    "age": null
                                }
                            ]
                        }
                    ]
                }
            }

+ Response 201 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "servicesQuote": {
                        "id": 356,
                        "title": "Mr",
                        "firstName": "Ravi",
                        "lastName": "Kumar",
                        "emailAddress": "ravi.kumar@britfss.co.uk",
                        "telephoneNumber": "07738998190",
                        "premiseID": null,
                        "bothAddressSame": false,
                        "supplyAddress": {
                            "flatNumber": 14,
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "country": null
                        },
                        "billingAddress": {
                            "flatNumber": 17,
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "country": null
                        },
                        "paymentMethod": "MDD",
                        "jci": false,
                        "status": null,
                        "servicesAccountNumber": null,
                        "productFeatures": [
                            "HC4|HC4-CH|CNI2|CHB|MDD",
                            "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "HC4|HC4-HEC|HNI2|EWR|MDD"
                        ],
                        "productConfigurations": [
                            {
                                "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                                "productAppliances": [
                                    {
                                        "applianceId": "CHB",
                                        "makeId": "QUdBLS0tQUdDIEhlYXRpbmc",
                                        "modelId": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                        "age": "5"
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                                "productAppliances": [
                                    {
                                        "applianceId": "PLDR",
                                        "makeId": null,
                                        "modelId": null,
                                        "age": null
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                                "productAppliances": [
                                    {
                                        "applianceId": "EWR",
                                        "makeId": null,
                                        "modelId": null,
                                        "age": null
                                    }
                                ]
                            }
                        ]
                    }
                },
                "errors": [],
                "meta": {}
            }

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "feature",
                        "message": "error.client.feature.invalid"
                    }
                ],
                "meta": {}
            }
        
### Retrieve the status of a services quote [GET /services-quotes/{id}/status]

+ Parameters

    + id (required, string) -  transactionId which is returned in Create services quote response

+ Request

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 200 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "transactionId": "23431234",
                    "status": "Checked-out",
                    "servicesAccountNumber": "911000626630"
                },
                "errors": {},
                "meta": {}
            }
        
+ Response 200 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "transactionId": "23431234",
                    "status": "In Progress",
                    "servicesAccountNumber": ""
                },
                "errors": {},
                "meta": {}
            }

+ Response 500 (application/json)

            {
              "status": "ERROR",
              "data": {},
              "errors": [
                {
                  "code": "service",
                  "message": "error.create.quote.cancelled"
                }
              ],
              "meta": {}
            }
        
+ Response 400 (application/json)
        
            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "paymentMethod",
                        "message": "error.client.paymentMethod.notMatching"
                    }
                ],
                "meta": {}
            }

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productConfigurations",
                        "message": "error.client.productConfigurations.productFeature.notMatching"
                    }
                ],
                "meta": {}
            }
        
+ Response 400 (application/json)
        
            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.applianceId.notMatching"
                    }
                ],
                "meta": {}
            }

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.notValid"
                    }
                ],
                "meta": {}
            }
