## Services-Leads Collection [/services-leads]

Services leads endpoint allows you to create a services lead in online database (PO_TA_SERVICES_LEAD). Responses from this endpoint will be retuned in JSON format only. All the customer & product details provided during services sales journey would be captured and posted to create services lead which would be sent to Uddingston for processing. After creating the lead, this endpoint will also trigger the confirmation email to customer.

>`Note:` Services leads endpoint will be able to handle only either a bundle product or an individual product at a time.

#### Services lead
Services lead as a resource represents following attributes.

| Property | Type | As request | As response | Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| id | String | `Optional` | `Returned always` | When an request is sent, the `id` attribute is unknown and hence it must be null. When the actual services lead is created, the response will have the `id` populated.|
| title | String | `Mandatory` | `Returned always` | Title of customer. |
| firstName | String | `Mandatory` | `Returned always` | First name of customer. |
| lastName | String | `Mandatory`| `Returned always` | LastName of customer. |
| emailAddress | String | `Mandatory` | `Returned always` | Email address of customer |
| telephoneNumber | String | `Mandatory`| `Returned always` | Phone number of customer |
| supplyAddress | [Address](/api-reference/addresses.md#addresses) | `Mandatory` | `Returned always` | Supply address of customer. Any one of the following - house number, flat number, house name and postal town and postcode are mandatory. Other address attributes must be passed if available.  |
| billingAddress | [Address](/api-reference/addresses.md#addresses) | `Optional` | `Returned always` | Billing address of customer. If `billingAddress` is not sent in the request `supplyAddress` is taken as `billingAddress` and will return the same. |
| directDebitDetails | [DirectDebit](/api-reference/services-contracts.md#DirectDebit) | `Mandatory` | `Returned always` | Direct debit details of customer.  |
| marketingConsentDetails | [MarketingConsent](/api-reference/services-contracts.md#MarketingConsent) | `Optional` | `Not returned always` | Marketting consent details which customer choose. |
| jci | boolean | `Optional` | `Returned always` | Status based on whether JCI was offered to customer or not. |
| productFeatures | String[] | `Mandatory` | `Returned always` | List of product features for which the quote is to be created. |
| productConfigurations | [ProductConfigurations](/api-reference/services-quotes.md#ProductConfigurations)[] | `Optional` | `Returned always` | List of product configurations for which the quote is to be created. |

### Post services sales data to Uddingston [POST /services-leads]
+ Request 'SUCCESS' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

    + Body

            {
                "servicesLead": {
                    "id": null,
                    "title": "Mr",
                    "firstName": "Ravi",
                    "lastName": "Kumar",
                    "emailAddress": "ravi.kumar@britfss.co.uk",
                    "telephoneNumber": "07738998190",
                    "supplyAddress": {
                        "flatNumber": 14,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ"
                    },
                    "billingAddress": {
                        "flatNumber": 17,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ"
                    },
                    "directDebitDetails": {
                        "paymentMethod": "MDD",
                        "bankAccountNumber": "93536377",
                        "sortCode": "208122",
                        "accountHolderName": "Deepak",
                        "preferredPaymentDay": 5
                    },
                    "marketingConsentDetails": {
                        "letterOpted": false,
                        "emailOpted": true,
                        "landlineOpted": false,
                        "mobileOpted": false,
                        "smsMmsOpted": false,
                        "facetoFaceOpted": false,
                        "ivmOpted": false
                    },
                    "jci": false,
                    "productFeatures": [
                        "HC4|HC4-CH|CNI2|CHB|MDD",
                        "HC4|HC4-PD|DNI2|PLDR|MDD",
                        "HC4|HC4-HEC|HNI2|EWR|MDD"
                    ],
                    "productConfigurations": [
                        {
                            "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "CHB",
                                    "make": "QUdBLS0tQUdDIEhlYXRpbmc",
                                    "model": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                    "age": 5
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "PLDR",
                                    "make": null,
                                    "model": null,
                                    "age": null
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "EWR",
                                    "make": null,
                                    "model": null,
                                    "age": null
                                }
                            ]
                        }
                    ]
                }
            }

+ Response 201 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "servicesLead": {
                        "id": "3445",
                        "title": "Mr",
                        "firstName": "Ravi",
                        "lastName": "Kumar",
                        "emailAddress": "ravi.kumar@britfss.co.uk",
                        "telephoneNumber": "07738998190",
                        "supplyAddress": {
                            "address": null,
                            "flatNumber": "14",
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "MPAN": null,
                            "MPRN": null
                        },
                        "billingAddress": {
                            "address": null,
                            "flatNumber": "17",
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "MPAN": null,
                            "MPRN": null
                        },
                        "marketingConsentDetails": {
                            "letterOpted": false,
                            "emailOpted": true,
                            "landlineOpted": false,
                            "mobileOpted": false,
                            "smsMmsOpted": false,
                            "facetoFaceOpted": false,
                            "ivmOpted": false
                        },
                        "directDebitDetails": {
                            "paymentMethod": "MDD",
                            "bankAccountNumber": "/15Gu1TGiWNQjjqW0sZxoA==",
                            "sortCode": "KRDmAEFzGOemFZROPx1gnQ==",
                            "accountHolderName": "Deepak",
                            "preferredPaymentDay": 5
                        },
                        "jci": false,
                        "productFeatures": [
                            "HC4|HC4-CH|CNI2|CHB|MDD",
                            "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "HC4|HC4-HEC|HNI2|EWR|MDD"
                        ],
                        "productConfigurations": [
                            {
                                "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "CHB",
                                        "make": "QUdBLS0tQUdDIEhlYXRpbmc",
                                        "model": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                        "age": 5
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "PLDR",
                                        "make": null,
                                        "model": null,
                                        "age": 5
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "EWR",
                                        "make": null,
                                        "model": null,
                                        "age": 5
                                    }
                                ]
                            }
                        ]
                    }
                },
                "errors": [],
                "meta": {}
            }

+ Request 'Input validations' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "feature",
                        "message": "error.client.feature.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Payment method not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "paymentMethod",
                        "message": "error.client.paymentMethod.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Product feature not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productConfigurations",
                        "message": "error.client.productConfigurations.productFeature.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Appliance id not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.appliance.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Product appliances invalid' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.invalid"
                    }
                ],
                "meta": {}
            }
