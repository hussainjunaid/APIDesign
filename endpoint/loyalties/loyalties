## Group Loyalties

## Loyalties Collection [/loyalties]
Loyalties endpoint allows you to create a loyalty card for a customer. Responses from this API will be retuned in JSON format only.
>`Note:` The payload should be of `JSON` format for this API. This API accepts requests only if the content-type is `application/json`.

#### Loyalty
Loyalty as a resource represents following information. This is equivalent of a nectar card supplied to the customer.
 
| Property | Type | Description |
| :-------------------- | :---------- | ------------------------------------------------------------ |
| id | string | `Returned always`. Loyalty card number associated to the customer. |
| title | string | `Returned always`. Title of the customer registering for Loyalty card. |
| firstName | string | `Returned always`. First name of the customer registering for Loyalty card. |
| surname | string | `Returned always`. Surname of the customer registering for Loyalty card. |
| telephoneNumber | string | `Returned always`. Telephone number of the customer registering for Loyalty card. |
| flatNumber | string | `Returned always`. Flat number of the address if available |
| houseNumber | string | `Returned always`. House number of the address if available. |
| houseName | string | `Returned always`. House name of the address if available. |
| addressLine1 | string | `Returned always`. Address line 1. Typically contains building name / street etc... |
| addressLine2 | string | `Returned always`. Address line 2. Typically contains street / avenues etc... |
| postalTown | string | `Returned always`. Postal town of the address. |
| county | string | `Returned always`. County to which the address belongs. |
| postcode | string | `Returned always`. Postcode of the address |
| emailAddress | string | `Returned always`. Email address of the customer attempting to register for a Loyalty card. |

#### Validations
Following validations apply on individual attributes

| Attribute | Validations |
| :-------------------- | ----------- |
| title | Cannot be `null` or `blank` |
|       | Cannot exceed `10` characters in length |
| firstName | Cannot be `null` or `blank`|
|           | Cannot be `"Occupier"` (or) `"The Occupier"` |
|           | Cannot exceed `24` characters in length |
| surname | Cannot be `null` or `blank` |
|         | Cannot be `"Occupier"` (or) `"The Occupier"` |
|           | Cannot exceed `32` characters in length |
| telephoneNumber | Cannot be `null` or `blank` |
|                 | Cannot be `non-numeric` |
|                 | Cannot be less than 10 characters in length and greater than 11 characters in length |
|                 | Must start with either `01`, `02`, `03` or `07` |
| flatNumber | Cannot exceed `30` characters in length |
|            | Cannot be `blank` or `null` when both `houseNumber` & `houseName` is not available |
| houseNumber | Cannot exceed `30` characters in length |
|             | Cannot be `blank` or `null` when both `flatNumber` & `houseName` is not available |
| houseName | Cannot exceed `75` characters in length |
|           | Cannot be `blank` or `null` when both `flatNumber` & `houseNumber` is not available |
| addressLine1 | `Optional`. Cannot exceed `50` characters in length |
| addressLine2 | `Optional`. Cannot exceed `50` characters in length |
| postalTown | Cannot be 'blank' or 'null' |
|            | Cannot exceed `30` characters in length |
| county | Cannot exceed `30` characters in length |
| postcode | Cannot be `null` or `blank` |
|          | UK postcode validations apply |
| emailAddress | Cannot be `null` or `blank` |
|              | Must satisfy regex `^[_+#~A-Za-z0-9-]+(\.[_#~+A-Za-z0-9-]+)*@[_+#~A-Za-z0-9-]+(\.[_+#~A-Za-z0-9-]+)*(\.[A-Za-z]{2,})$` |

### Create loyalty card [POST /loyalties]
+ Request (application/json)

  + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

  + Body

              {

              "loyalty": {
                  "id": null,
                  "title": "Mr",
                  "firstName": "Mark",
                  "surname": "Blair",
                  "telephoneNumber": "07404174628",
                  "flatNumber": "Flat 10",
                  "houseNumber": null,
                  "houseName": "Linden place",
                  "addressLine1": "Meadow Gardens",
                  "addressLine2": null,
                  "postalTown": "Staines",
                  "county": "Middlesex",
                  "postcode": "TW18 3HE",
                  "emailAddress": "test@bgdigitaltest.co.uk"
              }
            }


+ Response 200 (application/json)

          {
              "loyalty": {
                  "id": "91270909018",
                  "title": "Mr",
                  "firstName": "Mark",
                  "surname": "Blair",
                  "telephoneNumber": "07404174628",
                  "flatNumber": "Flat 10",
                  "houseNumber": null,
                  "houseName": "Linden place",
                  "addressLine1": "Meadow Gardens",
                  "addressLine2": null,
                  "postalTown": "Staines",
                  "county": "Middlesex",
                  "postcode": "TW18 3HE",
                  "emailAddress": "test@bgdigitaltest.co.uk"
              }
          }

+ Response 400 (application/json)

          {
              "status": "FAIL",
              "data": {},
              "errors": {
                  "postcode": "error.client.postcode.invalid"
              },
              "meta": {}
          }
