## Services-Quotes Collection [/services-quotes]

Services quotes endpoint allows you to create a services sales order in SAP. Responses from this endpoint will be retuned in JSON format only. All the customer & product details provided during services sales journey would be captured and posted to SAP which will then create an real time services contract.

>`Note:` Services quotes endpoint will be able to handle only either a bundle product or an individual product at a time.

#### Services quote
Services quote as a resource represents following attributes.

| Property | Type | As request | As response | Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| id | String | `Optional` | `Returned always` | When an request is sent, the `id` attribute is unknown and hence it must be null. When an actual services quote is created, the response will have the `id` populated.|
| title | String | `Mandatory` | `Returned always` | Title of customer. |
| firstName | String | `Mandatory` | `Returned always` | First name of customer. |
| lastName | String | `Mandatory`| `Returned always` | LastName of customer. |
| emailAddress | String | `Mandatory` | `Returned always` | Email address of customer |
| telephoneNumber | String | `Mandatory`| `Returned always` | Phone number of customer |
| premise | String | `Optional` | `Not returned always` | Premise id of an address. |
| supplyAddress | [Address](/api-reference/addresses.md#addresses) | `Mandatory` | `Returned always` | Supply address of customer. Any one of the following - house number, flat number, house name and postal town and postcode are mandatory. Other address attributes must be passed if available.  |
| billingAddress | [Address](/api-reference/addresses.md#addresses) | `Optional` | `Returned always` | Billing address of customer. If `billingAddress` is not sent in the request `supplyAddress` is taken as `billingAddress` and will return the same. |
| paymentMethod | String | `Mandatory` | `Returned always` | Payment method which customer choose.  |
| jci | boolean | `Optional` | `Returned always` | Status based on whether JCI was offered to customer or not. |
| productFeatures | String[] | `Mandatory` | `Returned always` | List of product features for which the quote is to be created. |
| productConfigurations | [ProductConfigurations](/api-reference/services-quotes.md#ProductConfigurations)[] | `Optional` | `Returned always` | List of product configurations for which the quote is to be created. |

##### ProductConfigurations
| Property | Type | As request | As response |Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| productFeature | String | `Mandatory` | `Returned always` | Product feature id for which the appliances details to be provided. |
| productAppliances | [ProductAppliances](/api-reference/services-quotes.md#ProductAppliances)[] | `Mandatory` | `Returned always` | Appliances details of a product with appliance type, make, model and age information. |

##### ProductAppliances
| Property | Type | As request | As response |Description |
| :-------------------- | :---------- | :----------  | :---------- | ------------------------------------------------------------ |
| appliance | String | `Mandatory` | `Returned always` | Appliance id of a product which customer choosen. |
| make | String| `Optional` | `Not returned always` | If customer choose any make the value can be passed. If value is not passed it is defaulted to value `Default` when sending it to backend.|
| model | String | `Optional` | `Not returned always` | If customer choose any model, the value can be passed. If value is not passed it is defaulted to value `Default` when sending it to backend.|
| age | Integer | `Optional` | `Returned always` | If customer choose any age the value can be passed. If value is not passed it is defaulted to value `5`.|


### Post a services quote to the backend systems [POST /services-quotes]

+ Request 'SUCCESS' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

    + Body

            {
                "servicesQuote": {
                    "id": null,
                    "title": "Mr",
                    "firstName": "Ravi",
                    "lastName": "Kumar",
                    "emailAddress": "ravi.kumar@britfss.co.uk",
                    "telephoneNumber": "07738998190",
                    "premise": null,
                    "supplyAddress": {
                        "flatNumber": 14,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ"
                    },
                    "billingAddress": {
                        "flatNumber": 17,
                        "houseNumber": null,
                        "houseName": "The Rushes",
                        "addressLine1": "Wapshott road",
                        "addressLine2": null,
                        "postalTown": "Staines",
                        "county": "Middlesex",
                        "postcode": "TW183EZ"
                    },
                    "paymentMethod": "MDD",
                    "jci": false,
                    "productFeatures": [
                        "HC4|HC4-CH|CNI2|CHB|MDD",
                        "HC4|HC4-PD|DNI2|PLDR|MDD",
                        "HC4|HC4-HEC|HNI2|EWR|MDD"
                    ],
                    "productConfigurations": [
                        {
                            "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "CHB",
                                    "make": "QUdBLS0tQUdDIEhlYXRpbmc",
                                    "model": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                    "age": 5
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "PLDR",
                                    "make": null,
                                    "model": null,
                                    "age": null
                                }
                            ]
                        },
                        {
                            "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                            "productAppliances": [
                                {
                                    "appliance": "EWR",
                                    "make": null,
                                    "model": null,
                                    "age": null
                                }
                            ]
                        }
                    ]
                }
            }

+ Response 201 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "servicesQuote": {
                        "id": 356,
                        "title": "Mr",
                        "firstName": "Ravi",
                        "lastName": "Kumar",
                        "emailAddress": "ravi.kumar@britfss.co.uk",
                        "telephoneNumber": "07738998190",
                        "premise": null,
                        "supplyAddress": {
                            "address": null,
                            "flatNumber": 14,
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "MPAN": null,
                            "MPRN": null
                        },
                        "billingAddress": {
                            "address": null,
                            "flatNumber": 17,
                            "houseNumber": null,
                            "houseName": "The Rushes",
                            "addressLine1": "Wapshott road",
                            "addressLine2": null,
                            "postalTown": "Staines",
                            "county": "Middlesex",
                            "postcode": "TW183EZ",
                            "MPAN": null,
                            "MPRN": null
                        },
                        "paymentMethod": "MDD",
                        "jci": false,
                        "productFeatures": [
                            "HC4|HC4-CH|CNI2|CHB|MDD",
                            "HC4|HC4-PD|DNI2|PLDR|MDD",
                            "HC4|HC4-HEC|HNI2|EWR|MDD"
                        ],
                        "productConfigurations": [
                            {
                                "productFeature": "HC4|HC4-CH|CNI2|CHB|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "CHB",
                                        "make": "QUdBLS0tQUdDIEhlYXRpbmc",
                                        "model": "QUdBLS0tQUdDIEhlYXRpbmctLS1TTTYw",
                                        "age": 5
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-PD|DNI2|PLDR|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "PLDR",
                                        "make": null,
                                        "model": null,
                                        "age": 5
                                    }
                                ]
                            },
                            {
                                "productFeature": "HC4|HC4-HEC|HNI2|EWR|MDD",
                                "productAppliances": [
                                    {
                                        "appliance": "EWR",
                                        "make": null,
                                        "model": null,
                                        "age": 5
                                    }
                                ]
                            }
                        ]
                    }
                },
                "errors": [],
                "meta": {}
            }

+ Request 'Input validations' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "feature",
                        "message": "error.client.feature.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Payment method not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "paymentMethod",
                        "message": "error.client.paymentMethod.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Product feature not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productConfigurations",
                        "message": "error.client.productConfigurations.productFeature.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Appliance id not matching' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.appliance.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Product appliances invalid' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 400 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "productAppliances",
                        "message": "error.client.productAppliances.invalid"
                    }
                ],
                "meta": {}
            }

+ Request 'Any back end system error' (application/json)

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 500 (application/json)

            {
                "status": "FAIL",
                "data": {},
                "errors": [
                    {
                        "code": "server.error.internal",
                        "message": "An internal error while processing request."
                    }
                ],
                "meta": {}
            }

### Retrieve the status of a services quote [GET /services-quotes/{id}/status]

+ Parameters

    + id: 1234 (required, string) -  transactionId which is returned in Create services quote response

+ Request 'When quote creation is successful'

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 200 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "status": "Checked-out",
                    "servicesAccountNumber": "911000626630"
                },
                "errors": {},
                "meta": {}
            }

+ Request 'When quote creation is in progress'

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526


+ Response 200 (application/json)

            {
                "status": "SUCCESS",
                "data": {
                    "transaction": "23431234",
                    "status": "In Progress",
                    "servicesAccountNumber": ""
                },
                "errors": {},
                "meta": {}
            }

+ Request 'Any back end system error'

    + Headers

            cid: 05e230bf-a9cf-4b31-bc54-d3a995f62526

+ Response 500 (application/json)

            {
              "status": "ERROR",
              "data": {},
              "errors": [
                {
                  "code": "server.error.internal",
                  "message": "An internal error while processing request."
                }
              ],
              "meta": {}
            }
